{% extends "resto_app/base.html" %}
{% block title %}{{ title }}{% endblock %}
{% block header_title %}{{ title }}{% endblock %}

{% block content %}
<div class="stack">
  <form method="post" class="card">
    {% csrf_token %}

    <div class="card__body">
      <div class="muted">Client</div>

      {% for field in form %}
        <label class="field">
          <span class="field__label">{{ field.label }}</span>
          {{ field }}
          {% if field.errors %}<span class="field__error">{{ field.errors|striptags }}</span>{% endif %}
        </label>
      {% endfor %}
    </div>

    <div class="divider"></div>

    <div class="card__body">
      <div class="row">
        <div class="title">Plats</div>
        <div class="muted">Lignes</div>
      </div>

      {{ formset.management_form }}

      <div class="stack-sm" style="margin-top:10px;">
        {% for f in formset %}
          <div class="card" style="box-shadow:none;">
            <div class="card__body">
              {{ f.id }}

              <label class="field">
                <span class="field__label">Plat</span>
                {{ f.plat }}
              </label>

              <label class="field">
                <span class="field__label">Quantit√©</span>
                {{ f.quantite }}
              </label>

              {% if f.DELETE %}
                <label class="field" style="flex-direction:row;align-items:center;gap:10px;">
                  {{ f.DELETE }}
                  <span class="muted">Supprimer cette ligne</span>
                </label>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>

      <div class="muted" style="margin-top:10px;">
        Pour plus de lignes, tu peux mettre <strong>extra=3</strong> dans forms.py.
      </div>
    </div>

    <div class="card__actions">
      <button class="btn btn--primary" type="submit">Enregistrer</button>
      <a class="btn btn--ghost" href="{% url 'commande_list' %}">Retour</a>
    </div>
  </form>
</div>
{% endblock %}
